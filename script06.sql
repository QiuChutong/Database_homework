PROMPT cq2039

-- Comments start with -- or are between /* and */

-- Clean up previously created tables; ignore error saying that the table does not exist

DROP TABLE Sells CASCADE CONSTRAINTS;
DROP TABLE Store CASCADE CONSTRAINTS;
DROP TABLE Company CASCADE CONSTRAINTS;
DROP TABLE Product CASCADE CONSTRAINTS;

DROP TABLE TEMP0 CASCADE CONSTRAINTS;
DROP TABLE TEMP1 CASCADE CONSTRAINTS;
DROP TABLE TEMP2 CASCADE CONSTRAINTS;
DROP TABLE TEMP3 CASCADE CONSTRAINTS;
DROP TABLE TEMP4 CASCADE CONSTRAINTS;
DROP TABLE TEMP5 CASCADE CONSTRAINTS;
DROP TABLE TEMP6 CASCADE CONSTRAINTS;
DROP TABLE TEMP7 CASCADE CONSTRAINTS;
DROP TABLE TEMP8 CASCADE CONSTRAINTS;
DROP TABLE TEMP9 CASCADE CONSTRAINTS;
DROP TABLE TEMP10 CASCADE CONSTRAINTS;
DROP TABLE TEMP11 CASCADE CONSTRAINTS;
DROP TABLE TEMP12 CASCADE CONSTRAINTS;
DROP TABLE TEMP13 CASCADE CONSTRAINTS;
DROP TABLE TEMP14 CASCADE CONSTRAINTS;
DROP TABLE TEMP15 CASCADE CONSTRAINTS;
DROP TABLE TEMP16 CASCADE CONSTRAINTS;
DROP TABLE TEMP17 CASCADE CONSTRAINTS;
DROP TABLE TEMP18 CASCADE CONSTRAINTS;
DROP TABLE TEMP19 CASCADE CONSTRAINTS;
DROP TABLE TEMP20 CASCADE CONSTRAINTS;

DROP TABLE ANSWER0 CASCADE CONSTRAINTS;
DROP TABLE ANSWER1 CASCADE CONSTRAINTS;
DROP TABLE ANSWER2 CASCADE CONSTRAINTS;
DROP TABLE ANSWER3 CASCADE CONSTRAINTS;
DROP TABLE ANSWER4 CASCADE CONSTRAINTS;
DROP TABLE ANSWER5 CASCADE CONSTRAINTS;
DROP TABLE ANSWER6 CASCADE CONSTRAINTS;
DROP TABLE ANSWER7 CASCADE CONSTRAINTS;
DROP TABLE ANSWER8 CASCADE CONSTRAINTS;
DROP TABLE ANSWER9 CASCADE CONSTRAINTS;
DROP TABLE ANSWER10 CASCADE CONSTRAINTS;

-- Create the database

CREATE TABLE Product (
				UPC INTEGER NOT NULL,
				Name VARCHAR(10),
				CONSTRAINT PRODUCT_PK PRIMARY KEY (UPC)
);

CREATE TABLE Company (
				CompanyTIN INTEGER NOT NULL,
				Earnings INTEGER,
				CONSTRAINT COMPANY_PK PRIMARY KEY (CompanyTIN)
);

CREATE TABLE Store (
				StoreID INTEGER NOT NULL,
				CompanyTIN INTEGER NOT NULL,
				State VARCHAR(10),
				Manager VARCHAR(10),
				CONSTRAINT STORE_PK PRIMARY KEY (StoreID, CompanyTIN),
				CONSTRAINT STORE_UN UNIQUE (Manager)
);

CREATE TABLE Sells (
				UPC INTEGER NOT NULL ,
				StoreID INTEGER NOT NULL,
				CompanyTIN INTEGER NOT NULL,
				Price INTEGER NOT NULL,
				Quantity INTEGER,
				CONSTRAINT SELLS_PK PRIMARY KEY (UPC, StoreID, CompanyTIN)
);

ALTER TABLE Sells ADD CONSTRAINT PRODUCT_SELLS_FK
FOREIGN KEY (UPC)
REFERENCES Product (UPC)
;

ALTER TABLE Store ADD CONSTRAINT COMPANY_STORE_FK
FOREIGN KEY (CompanyTIN)
REFERENCES Company (CompanyTIN)
;

ALTER TABLE Sells ADD CONSTRAINT STORE_SELLS_FK
FOREIGN KEY (StoreID, CompanyTIN)
REFERENCES Store (StoreID, CompanyTIN)
;

/* Populate the database */

INSERT INTO Company (CompanyTIN, Earnings) VALUES (121370174, 20000);
INSERT INTO Company (CompanyTIN, Earnings) VALUES (976382037, 16000);
INSERT INTO Company (CompanyTIN, Earnings) VALUES (448573597, 100000);
INSERT INTO Company (CompanyTIN, Earnings) VALUES (261760821, -4000);
INSERT INTO Company (CompanyTIN, Earnings) VALUES (315145601, 80000);
INSERT INTO Company (CompanyTIN, Earnings) VALUES (325372264, 0);

INSERT INTO Product (UPC, Name) VALUES (100873, 'Almonds');
INSERT INTO Product (UPC, Name) VALUES (166363, 'Blueberry');
INSERT INTO Product (UPC, Name) VALUES (142349, 'Carrot');
INSERT INTO Product (UPC, Name) VALUES (114879, 'Dumpling');
INSERT INTO Product (UPC, Name) VALUES (182879, 'Eggplant');
INSERT INTO Product (UPC, Name) VALUES (101690, 'Ginger');
INSERT INTO Product (UPC, Name) VALUES (105918, 'Hummus');
INSERT INTO Product (UPC, Name) VALUES (196178, 'Jalapeno');
INSERT INTO Product (UPC, Name) VALUES (166678, 'Lemonade');
INSERT INTO Product (UPC, Name) VALUES (161319, 'Melon');
INSERT INTO Product (UPC, Name) VALUES (126901, 'Olives');

INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (548, 448573597, 'MA', 'Ivan');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (939, 261760821, 'NY', 'Laura');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (874, 121370174, 'PA', 'Mandy');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (375, 325372264, 'NY', 'Travis');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (366, 976382037, 'PA', 'Al');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (960, 325372264, 'PA', 'Max');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (375, 261760821, 'MA', 'Null');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (960, 121370174, 'NJ', 'Jim');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (269, 325372264, 'NY', 'Minnie');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (637, 448573597, 'NJ', 'Kim');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (847, 976382037, 'NY', 'Allan');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (171, 315145601, 'NJ', 'Angie');
INSERT INTO Store (StoreID, CompanyTIN, State, Manager) VALUES (960, 315145601, 'NY', 'Amanda');

INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (105918, 960, 315145601, 50, 118);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (182879, 960, 325372264, 16, 50);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (166363, 375, 325372264, 11, 50);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (101690, 548, 448573597, 56, 130);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (114879, 939, 261760821, 10, 20);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (126901, 939, 261760821, 46, 30);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (126901, 375, 261760821, 26, 35);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (161319, 960, 121370174, 15, 3);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (166363, 874, 121370174, 32, 140);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (142349, 366, 976382037, 66, 260);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (166363, 366, 976382037, 77, 55);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (114879, 548, 448573597, 56, 19);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (142349, 375, 325372264, 78, 5);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (166678, 375, 261760821, 16, 50);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (182879, 939, 261760821, 56, 20);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (105918, 960, 121370174, 24, 15);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (100873, 548, 448573597, 16, 80);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (161319, 960, 325372264, 26, 30);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (182879, 637, 448573597, 77, 8);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (114879, 847, 976382037, 16, 15);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (161319, 939, 261760821, 78, 20);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (166363, 847, 976382037, 32, 32);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (182879, 375, 325372264, 77, 2);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (166678, 548, 448573597, 16, 50);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (105918, 960, 325372264, 80, 32);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (101690, 171, 315145601, 56, 100);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (161319, 171, 315145601, 16, 4);
INSERT INTO Sells (UPC, StoreID, CompanyTIN, Price, Quantity) VALUES (161319, 960, 315145601, 56, 85);


-- Print the database

SELECT * FROM Company;
SELECT * FROM Product;
SELECT * FROM Store;
SELECT * FROM Sells;

/*

YOU START YOUâ€™RE ANSWERS AFTER THE END OF THIS COMMENT BLOCK

ANSWER0 is an example to show you the structure of what you need to produce, unless instructed otherwise in the assignment. Please read carefully what you are asked to do.

Insert your solution for ANSWERX between the string -- ANSWERX and the string PROMPT ANSWERX

*/

-- ANSWER0
CREATE TABLE TEMP0
AS SELECT StoreID, CompanyTIN
FROM Sells
WHERE Price > 1;

CREATE TABLE ANSWER0
AS SELECT DISTINCT CompanyTIN AS CompName
FROM TEMP0
ORDER BY CompName asc;

PROMPT ANSWER0
SELECT * FROM ANSWER0;

-- ANSWER1
CREATE TABLE ANSWER1
AS SELECT DISTINCT State, CompanyTIN, StoreID
FROM Store
ORDER BY StoreID ASC, CompanyTIN ASC, State DESC;

PROMPT ANSWER1
SELECT * FROM ANSWER1;

-- ANSWER2
CREATE TABLE ANSWER2
AS SELECT CompanyTIN AS Company
FROM Store
WHERE State='NY'
ORDER BY Company ASC;

PROMPT ANSWER2
SELECT * FROM ANSWER2;

-- ANSWER3
CREATE TABLE ANSWER3
AS SELECT DISTINCT StoreID AS Store
FROM Sells
WHERE UPC <> 114879
ORDER BY Store ASC;

PROMPT ANSWER3
SELECT * FROM ANSWER3;

-- ANSWER4
CREATE TABLE ANSWER4
AS SELECT DISTINCT S1.StoreID AS ID1, S2.StoreID AS ID2, S1.UPC, S1.Price
FROM Sells S1, Sells S2
WHERE S1.StoreID<>S2.StoreID AND S1.UPC=S2.UPC AND S1.Price=S2.Price
ORDER BY ID1 ASC;

PROMPT ANSWER4
SELECT * FROM ANSWER4;

-- ANSWER5
CREATE TABLE TEMP5
AS SELECT DISTINCT T.State, E.UPC, P.Name
FROM Store T, Sells E, Product P
WHERE T.StoreID=E.StoreID AND P.UPC=E.UPC;

CREATE TABLE ANSWER5
AS SELECT DISTINCT State
FROM TEMP5
WHERE Name='Blueberry' 
INTERSECT
SELECT DISTINCT State
FROM TEMP5
WHERE Name='Eggplant'
ORDER BY State ASC;

PROMPT ANSWER5
SELECT * FROM ANSWER5;

-- ANSWER6
CREATE TABLE TEMP6
AS SELECT DISTINCT C.Earnings, S.Price
FROM Company C, Sells S
WHERE C.CompanyTIN=S.CompanyTIN;

CREATE TABLE ANSWER6
AS SELECT DISTINCT Earnings
FROM TEMP6
WHERE Price>=50
ORDER BY Earnings DESC;

PROMPT ANSWER6
SELECT * FROM ANSWER6;

-- ANSWER7
CREATE TABLE TEMP7
AS SELECT DISTINCT S.StoreID, S.CompanyTIN, P.Name
FROM Sells S, Product P
WHERE S.UPC=P.UPC;

CREATE TABLE ANSWER7
AS SELECT DISTINCT StoreID, CompanyTIN
FROM TEMP7
WHERE Name='Carrot' OR Name='Lemonade'
ORDER BY StoreID ASC;

PROMPT ANSWER7
SELECT * FROM ANSWER7;

-- ANSWER8

PROMPT ANSWER8
SELECT * FROM ANSWER8;

-- ANSWER9

PROMPT ANSWER9
SELECT * FROM ANSWER9;

-- ANSWER10

PROMPT ANSWER10
SELECT * FROM ANSWER10;